<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/base :: headPadrao('Afiliar-se')}">
</head>

<body>

<header th:replace="~{fragments/base :: cabecalho}"></header>
<main class="container">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="form-container">
                <h2 class="form-title text-center">
                    <i class="bi bi-heart-fill me-2"></i>Inscrição
                </h2>

                <!-- Mensagens -->
                <div class="container mt-3" th:if="${(msg != null and !#strings.isEmpty(msg)) or (erro != null and !#strings.isEmpty(erro))}">
                    <div class="alert alert-success alert-dismissible fade show" role="alert"
                         th:if="${msg != null and !#strings.isEmpty(msg)}">
                        <span th:text="${msg}">Ação realizada com sucesso!</span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>

                    <div class="alert alert-danger alert-dismissible fade show" role="alert"
                         th:if="${erro != null and !#strings.isEmpty(erro)}">
                        <span th:text="${erro}">Ocorreu um erro</span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                </div>

                <!-- Formulário -->
                <form th:action="@{/doadores/salvar}" th:object="${doador}" method="post">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" th:if="${_csrf != null}"/>

                    <div class="row">
                        <!-- Nome Completo -->
                        <div class="col-md-12 mb-3">
                            <label for="nome" class="form-label">Nome Completo *</label>
                            <input type="text"
                                   class="form-control"
                                   id="nome"
                                   th:field="*{nome}"
                                   required
                                   placeholder="Digite seu nome completo">
                        </div>

                        <!-- CPF/CNPJ -->
                        <div class="col-md-6 mb-3">
                            <label for="cpfCnpj" class="form-label">CPF/CNPJ *</label>
                            <input type="text"
                                   class="form-control"
                                   id="cpfCnpj"
                                   th:field="*{cpfCnpj}"
                                   required
                                   placeholder="000.000.000-00">
                            <div class="form-text">Digite CPF para pessoa física ou CNPJ para pessoa jurídica</div>
                        </div>

                        <!-- Telefone -->
                        <div class="col-md-6 mb-3">
                            <label for="telefone" class="form-label">Telefone *</label>
                            <input type="text"
                                   class="form-control"
                                   id="telefone"
                                   th:field="*{telefone}"
                                   required
                                   placeholder="(00) 00000-0000">
                        </div>

                        <!-- Email -->
                        <div class="col-md-12 mb-3">
                            <label for="email" class="form-label">Email *</label>
                            <input type="email"
                                   class="form-control"
                                   id="email"
                                   th:field="*{email}"
                                   required
                                   placeholder="seu@email.com">
                        </div>

                        <!-- Mensalidade -->
                        <div class="col-md-12 mb-4">
                            <label for="mensalidade" class="form-label">Valor da Mensalidade (R$)</label>
                            <input type="number"
                                   class="form-control"
                                   id="mensalidade"
                                   th:field="*{mensalidade}"
                                   min="0"
                                   step="0.01"
                                   placeholder="Ex: 50.00">
                            <div class="form-text">Valor que deseja contribuir mensalmente (opcional)</div>
                        </div>
                    </div>

                    <!-- Botões -->
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="reset" class="btn btn-outline-secondary me-md-2">
                            <i class="bi bi-arrow-counterclockwise me-1"></i>Limpar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-send-check me-1"></i>Enviar Inscrição
                        </button>
                    </div>
                </form>
            </div>

            <!-- Informações Adicionais -->
            <div class="card mt-4">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="bi bi-info-circle-fill me-2"></i>Por que ser doador?
                    </h5>
                    <p class="card-text">
                        Sua contribuição é fundamental para manter os serviços da ASSANDEF e melhorar a qualidade de vida
                        das pessoas com deficiência física em nossa comunidade. Com sua ajuda, podemos:
                    </p>
                    <ul>
                        <li>Fornecer equipamentos de reabilitação</li>
                        <li>Manter os programas de inclusão social</li>
                        <li>Oferecer atendimento especializado</li>
                        <li>Realizar eventos e atividades recreativas</li>
                    </ul>
                    <p class="mb-0">
                        <strong>Junte-se a nós nesta causa!</strong>
                    </p>
                </div>
            </div>
        </div>
    </div>
</main>
<footer th:replace="~{fragments/base :: rodape}"></footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Máscaras para campos -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Máscara para CPF/CNPJ
        const cpfCnpjInput = document.getElementById('cpfCnpj');
        if (cpfCnpjInput) {
            cpfCnpjInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length <= 11) {
                    // CPF
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
                } else {
                    // CNPJ
                    value = value.replace(/(\d{2})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1.$2');
                    value = value.replace(/(\d{3})(\d)/, '$1/$2');
                    value = value.replace(/(\d{4})(\d{1,2})$/, '$1-$2');
                }
                e.target.value = value;
            });
        }

        // Máscara para telefone
        const telefoneInput = document.getElementById('telefone');
        if (telefoneInput) {
            telefoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 11) value = value.substring(0, 11);

                if (value.length > 0) {
                    value = '(' + value;
                }
                if (value.length > 3) {
                    value = value.substring(0, 3) + ') ' + value.substring(3);
                }
                if (value.length > 10) {
                    value = value.substring(0, 10) + '-' + value.substring(10);
                }
                e.target.value = value;
            });
        }
    });
</script>
</body>
</html>